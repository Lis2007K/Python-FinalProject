================================================================================
                    PERSONAL FINANCE TRACKER - PROJECT DOCUMENTATION
                              January 29, 2026
================================================================================

PROJECT OVERVIEW:
A comprehensive personal finance management application built with Python, featuring
both a Streamlit web UI and a FastAPI REST API. The application provides user 
authentication, transaction management (CRUD operations), analytics with professional
visualizations, and data export capabilities.

================================================================================
                              PROJECT STRUCTURE
================================================================================

Python-FinalProject/
├── main.py                          # Streamlit UI application (Entry point)
├── requirements.txt                 # Project dependencies
├── API_GUIDE.md                     # API documentation and usage examples
├── PROJECT_DOCUMENTATION.txt        # This file
├── api/                             # API module
│   ├── __init__.py
│   ├── api_simulation.py            # API handler functions
│   └── api_server.py                # FastAPI server with CRUD endpoints
├── auth/                            # Authentication module
│   ├── __init__.py
│   ├── auth_service.py              # User login/register logic
│   └── auth_utils.py                # Password validation helpers
├── config/                          # Configuration module
│   ├── __init__.py
│   └── settings.py                  # App settings and paths
├── database/                        # Database module
│   ├── __init__.py
│   ├── db.py                        # SQLite database operations
│   └── models.py                    # Data models (User, Transaction)
├── finance/                         # Finance module
│   ├── __init__.py
│   ├── finance_service.py           # Business logic for transactions
│   ├── categories.py                # Income/expense categories
│   └── transaction.py               # Transaction utilities
├── utils/                           # Utility functions
│   ├── __init__.py
│   ├── exporters.py                 # CSV export functionality
│   ├── helpers.py                   # Date parsing and formatting
│   └── validators.py                # Input validation helpers
└── visualization/                   # Charts and analytics
    ├── __init__.py
    └── charts.py                    # Matplotlib chart functions

================================================================================
                              DETAILED FILE DESCRIPTIONS
================================================================================

--- ROOT LEVEL ---

1. main.py (280+ lines)
   PURPOSE: Streamlit web application entry point
   FEATURES:
   - User authentication (login/register with tabs)
   - Dashboard with 4 metrics (Total Income, Total Expenses, Net Balance, Current Balance)
   - Transaction form for adding new income/expense entries
   - Transactions table with CSV export capability
   - Analytics dashboard with 5 tabbed chart views
   - Sidebar logout functionality
   - Session state management for user persistence
   
   KEY SECTIONS:
   - Auth flow: Handles user registration and login
   - Dashboard metrics: Displays financial summary
   - Add Transaction: Form-based transaction creation
   - Transactions table: Displays all user transactions
   - Analytics tabs: 5 different visualization views
   
   IMPORTS: Uses Streamlit, auth, finance, visualization modules
   RUN: streamlit run main.py (launches on http://localhost:8502)

2. requirements.txt
   DEPENDENCIES:
   - streamlit>=1.30        # Web UI framework
   - sqlalchemy>=2.0        # ORM (not actively used, but installed)
   - pandas>=2.0            # Data manipulation
   - matplotlib>=3.7        # Chart creation
   - bcrypt>=4.0            # Password hashing (not actively used)
   - python-dateutil>=2.8   # Date parsing utilities

3. API_GUIDE.md
   Comprehensive guide showing:
   - How to run both Streamlit UI and FastAPI server
   - CRUD endpoint examples with curl commands
   - Authentication endpoints
   - Authentication responses
   - Monthly summary endpoint
   - Running both servers simultaneously

4. PROJECT_DOCUMENTATION.txt (This file)
   Complete project documentation with detailed descriptions of all files

--- API FOLDER ---

1. api/__init__.py
   Empty initialization file for the api package

2. api/api_simulation.py (60+ lines)
   PURPOSE: API handler functions that bridge FastAPI requests to business logic
   FUNCTIONS:
   - api_register(): User registration with validation
   - api_login(): User authentication returning safe user data
   - api_get_transactions(): Retrieve user transactions with filtering support
   - api_post_transaction(): Create new transaction with validation
   - api_update_transaction(): Update existing transaction (full replacement)
   - api_delete_transaction(): Delete transaction (with auth check)
   - api_get_monthly_summary(): Get monthly income/expense aggregates
   
   DESIGN PATTERN: Each function returns {"success": bool, "message"/"data": any}
   AUTH CHECK: All transaction endpoints verify user_id (basic auth)
   IMPORTS: auth, finance_service, database.db modules

3. api/api_server.py (165+ lines)
   PURPOSE: FastAPI server providing REST API endpoints
   FRAMEWORK: FastAPI with Pydantic models for request validation
   
   ENDPOINTS:
   Authentication:
   - POST /auth/register        # Register new user
   - POST /auth/login           # Login and get user info
   
   Transactions (CRUD):
   - GET /transactions          # Read all transactions
   - POST /transactions         # Create transaction
   - PUT /transactions/{tx_id}  # Update transaction
   - DELETE /transactions/{tx_id} # Delete transaction
   
   Analytics:
   - GET /monthly-summary       # Get monthly summary
   
   Other:
   - GET /                      # Health check
   
   REQUEST MODELS:
   - RegisterRequest: {username, password}
   - LoginRequest: {username, password}
   - TransactionRequest: {date_iso, amount, category, ttype, description}
   - TransactionUpdateRequest: Same as TransactionRequest
   
   FEATURES:
   - Automatic OpenAPI/Swagger documentation at /docs
   - HTTP exception handling with proper status codes
   - Pydantic validation on all inputs
   - Separation of concerns (FastAPI handles HTTP, api_simulation handles logic)
   
   RUN: uvicorn api/api_server:app --reload (launches on http://localhost:8000)

--- AUTH FOLDER ---

1. auth/__init__.py
   Exports: register_user, login_user, current_user_safe

2. auth/auth_service.py (45 lines)
   PURPOSE: User authentication service
   FUNCTIONS:
   - register_user(username, password) → (success: bool, message: str)
     * Validates credentials using auth_utils.validate_username_password()
     * Creates user in database via db.create_user()
     * Returns success status and message
   
   - login_user(username, password) → (success: bool, user: User or None)
     * Verifies credentials via db.verify_user()
     * Returns user object if successful
   
   - current_user_safe(user: User) → dict
     * Converts User object to safe dict (no password hash)
     * Returns: {"id", "username", "created_at"}
   
   SECURITY: Uses database-level password hashing (SHA256 with salt)

3. auth/auth_utils.py
   PURPOSE: Authentication validation helpers
   FUNCTIONS:
   - validate_username_password(username, password) → (ok: bool, message: str)
     * Checks username and password meet minimum requirements
     * Ensures username is not empty
     * Ensures password is not empty

--- CONFIG FOLDER ---

1. config/__init__.py
   Empty initialization file

2. config/settings.py (15 lines)
   PURPOSE: Central configuration management
   VARIABLES:
   - BASE_DIR: Project root directory path
   - DATA_DIR: data/ folder (auto-created if missing)
   - DB_PATH: Path to finance.db SQLite database
   - DEFAULT_CURRENCY: "USD"
   - SECRET_SALT: Salt for password hashing (should be changed in production)
   
   DESIGN: Centralized config prevents hardcoded paths throughout codebase

--- DATABASE FOLDER ---

1. database/__init__.py
   Empty initialization file

2. database/models.py (45 lines)
   PURPOSE: Data models using Python dataclasses
   
   CLASSES:
   - User:
     * Fields: id (int), username (str), password_hash (str), created_at (str)
     * Static method from_row(row): Converts SQLite row to User object
   
   - Transaction:
     * Fields: id (int), user_id (int), date (str, ISO format), amount (float),
               category (str), ttype (str: 'income'/'expense'), description (str or None)
     * Static method from_row(row): Converts SQLite row to Transaction object

3. database/db.py (200+ lines)
   PURPOSE: SQLite database operations and CRUD functions
   
   CONNECTION:
   - get_connection(): Returns SQLite connection with row_factory set
   - Uses check_same_thread=False for Streamlit compatibility
   
   INITIALIZATION:
   - init_db(): Creates users and transactions tables if not exist
   
   USER OPERATIONS:
   - create_user(username, password): Insert new user
   - get_user_by_username(username): Query user by username
   - verify_user(username, password): Authenticate user
   - _hash_password(password): SHA256 hash with salt
   
   TRANSACTION OPERATIONS:
   - add_transaction(user_id, date_iso, amount, category, ttype, description): Create
   - get_transactions_by_user(user_id, limit): Read all transactions for user
   - get_transaction_by_id(tx_id): Read single transaction
   - update_transaction(tx_id, user_id, ...): Update transaction (auth check included)
   - delete_transaction(tx_id, user_id): Delete transaction (auth check included)
   
   ANALYTICS:
   - get_balance(user_id): Calculate net balance (income - expense)
   - get_monthly_summary(user_id): Returns list of dicts:
     * {"month": "YYYY-MM", "income": float, "expense": float}
     * Grouped by month, ordered chronologically
   
   SECURITY: Uses parameterized queries to prevent SQL injection

--- FINANCE FOLDER ---

1. finance/__init__.py
   Exports: get_categories, add_transaction_validated, get_transactions_filtered,
            export_transactions_csv, get_monthly_summary, calculate_balance

2. finance/categories.py
   PURPOSE: Category definitions for transactions
   PROVIDES:
   - get_categories(ttype): Returns list of categories for 'income' or 'expense'
   - Predefined categories for income: Salary, Bonus, Investment, Other
   - Predefined categories for expense: Food, Transport, Utilities, Entertainment, Other

3. finance/finance_service.py (150+ lines)
   PURPOSE: Business logic layer for transaction operations
   KEY FUNCTIONS:
   
   - add_transaction_validated(user_id, date_iso, amount, category, ttype, description):
     * Validates date format (ISO YYYY-MM-DD)
     * Validates amount > 0
     * Validates ttype is 'income' or 'expense'
     * Validates category is not empty
     * Returns (success, message) after calling db.add_transaction()
   
   - update_transaction_validated(user_id, tx_id, date_iso, amount, ...):
     * Same validation as add_transaction_validated
     * Includes user authorization check
     * Calls db.update_transaction()
   
   - delete_transaction(user_id, tx_id):
     * Verifies user authentication
     * Calls db.delete_transaction() with auth check
   
   - get_transactions_filtered(user_id, limit, start_date, end_date, category):
     * Retrieves transactions from db.get_transactions_by_user()
     * Filters by date range (inclusive)
     * Filters by category (exact match)
     * Default limit: 500 transactions
   
   - calculate_balance(user_id): Wrapper for db.get_balance()
   
   - export_transactions_csv(user_id, filepath, txs):
     * Exports transactions to CSV file
     * Default path: data/transactions_export_{user_id}_{date}.csv
     * Columns: id, user_id, date, amount, category, type, description
     * Returns (success, filepath_or_error)
   
   DESIGN PATTERN: Service layer validates input before database operations

4. finance/transaction.py
   PURPOSE: Transaction utilities (may be minimal)

--- UTILS FOLDER ---

1. utils/__init__.py
   Empty initialization file

2. utils/helpers.py (15 lines)
   PURPOSE: Common utility functions
   FUNCTIONS:
   - parse_date(date_str): Parses various date formats, returns ISO YYYY-MM-DD
   - format_currency(amount, currency): Formats amount as "CURRENCY amount.00"
   - safe_str(value): Returns "" if None, else str(value)
   
   DEPENDENCIES: Uses dateutil.parser for flexible date parsing

3. utils/validators.py
   PURPOSE: Input validation helpers (specifics vary)

4. utils/exporters.py
   PURPOSE: Data export utilities (CSV, etc.)

--- VISUALIZATION FOLDER ---

1. visualization/__init__.py
   Empty initialization file

2. visualization/charts.py (220+ lines)
   PURPOSE: Matplotlib-based chart functions for analytics
   
   CHARTS (Functions):
   
   - plot_monthly_summary(summary: List[Dict]) → matplotlib.Figure:
     * Line chart showing income, expense, and net balance trends
     * X-axis: Months in YYYY-MM format
     * Y-axis: Amount ($)
     * 3 lines: Income (green), Expense (red), Net (blue dashed)
     * Value labels on each data point
     * Figure size: 14x6, grid enabled
   
   - pie_expense_by_category(transactions, month_iso=None) → matplotlib.Figure:
     * Horizontal bar chart of expenses by category
     * Sorted by amount (descending)
     * Value labels on each bar
     * Color gradient applied to bars
     * Optional filtering by month
     * Figure size: 10x6
   
   - plot_income_vs_expense_bars(summary: List[Dict]) → matplotlib.Figure:
     * Side-by-side bar chart comparing monthly income vs expense
     * Income bars: green (#27ae60)
     * Expense bars: red (#e74c3c)
     * Value labels on top of bars
     * Grid on Y-axis
     * Figure size: 12x6
   
   - plot_category_income_expense(transactions) → matplotlib.Figure:
     * Donut chart showing transaction distribution across all categories
     * Percentage labels with white text
     * Includes pie chart with center circle cutout
     * Color scheme: Set3 matplotlib palette
     * Figure size: 8x8
   
   - plot_cumulative_balance(transactions) → matplotlib.Figure:
     * Line chart showing running balance over time
     * Calculated as cumulative sum of income minus expense
     * Blue line with markers
     * Filled area under curve
     * Zero-line reference (black dashed)
     * Shows balance progression from first to latest transaction
     * Figure size: 12x6
   
   STYLING FEATURES ACROSS ALL CHARTS:
   - Bold titles with larger font
   - Labeled axes with bold font
   - Grid with transparency for readability
   - Proper legend placement
   - Rotated x-axis labels where needed
   - Professional color scheme
   - Tight layout to prevent label cutoff

================================================================================
                              APPLICATION FLOW
================================================================================

STREAMLIT UI FLOW (main.py):
1. User visits http://localhost:8502
2. If not logged in: Shows Login/Register tabs
   - Register: Takes username/password → calls auth.register_user()
   - Login: Takes username/password → calls auth.login_user()
3. If logged in: Shows main dashboard
   - Dashboard: Displays 4 metrics (income, expense, net, balance)
   - Add Transaction: Form to create new income/expense
   - Transactions: Table of all transactions with CSV export
   - Analytics: 5-tab analytics view
     * Tab 1: Monthly Trend (line chart)
     * Tab 2: Income vs Expense Comparison (bar chart)
     * Tab 3: Expense Distribution (horizontal bar chart)
     * Tab 4: Category Distribution (donut chart)
     * Tab 5: Cumulative Balance (area+line chart)

FASTAPI REST API FLOW (api/api_server.py):
1. Client sends HTTP request to /endpoint
2. FastAPI validates request using Pydantic models
3. Calls corresponding function from api_simulation.py
4. Function validates inputs and calls finance_service.py
5. finance_service validates data and calls database.db
6. db.py executes SQL and returns results
7. Response flows back up through layers as JSON
8. FastAPI returns JSON response with proper HTTP status code

DATABASE INTERACTIONS:
1. All database access goes through database/db.py
2. User passwords are hashed with SHA256 + salt in config/settings.py
3. Transactions are stored with user_id for isolation
4. Foreign key constraint: transaction.user_id → user.id
5. SQLite database stored at: data/finance.db (auto-created on init)

================================================================================
                           CRUD OPERATIONS EXPLAINED
================================================================================

CREATE (Add Transaction):
- Endpoint: POST /transactions?user_id={user_id}
- Streamlit UI: Form in main.py → finance_service.add_transaction_validated()
- Validates: date (ISO format), amount (>0), category, type (income/expense)
- Database: Inserts into transactions table
- Returns: {"success": true, "message": "Saved"}

READ (Get Transactions):
- Endpoint: GET /transactions?user_id={user_id}
- Streamlit UI: Displays in dataframe, passes to chart functions
- Functions: api_get_transactions() → finance_service.get_transactions_filtered()
- Filtering: By date range, category, limit (default 500)
- Returns: {"success": true, "transactions": [...]}

UPDATE (Modify Transaction):
- Endpoint: PUT /transactions/{tx_id}?user_id={user_id}
- Streamlit UI: Not currently implemented in UI (API-only)
- Validation: Same as CREATE
- Authorization: Must be owner (user_id matches)
- Database: Updates row by id and user_id
- Returns: {"success": true/false, "message": "Updated/Error"}

DELETE (Remove Transaction):
- Endpoint: DELETE /transactions/{tx_id}?user_id={user_id}
- Streamlit UI: Not currently implemented in UI (API-only)
- Authorization: Must be owner (user_id matches)
- Database: Deletes row by id and user_id
- Returns: {"success": true/false, "message": "Deleted/Error"}

================================================================================
                              HOW TO RUN
================================================================================

PREREQUISITES:
- Python 3.8+
- pip (Python package manager)
- Virtual environment (recommended)

SETUP:
1. Navigate to project directory:
   cd c:\Users\CDF-HIV-06\Desktop\Python-FinalProject\Python-FinalProject

2. Create virtual environment (optional but recommended):
   python -m venv venv
   venv\Scripts\activate

3. Install dependencies:
   pip install -r requirements.txt

4. Initialize database (optional, auto-initializes on first run):
   python -c "from database.db import init_db; init_db()"

RUNNING STREAMLIT UI:
   streamlit run main.py
   Opens at: http://localhost:8502

RUNNING FASTAPI REST API:
   uvicorn api/api_server:app --reload
   Opens at: http://localhost:8000
   API Docs: http://localhost:8000/docs

RUNNING BOTH SIMULTANEOUSLY:
   Terminal 1: streamlit run main.py
   Terminal 2: uvicorn api/api_server:app --reload

================================================================================
                            KEY DESIGN DECISIONS
================================================================================

1. LAYERED ARCHITECTURE:
   - UI (Streamlit) → API Logic (api_simulation) → Business Logic (finance_service)
   - → Database (db.py)
   - Separation of concerns ensures maintainability

2. DUAL INTERFACES:
   - Streamlit for user-friendly web interface
   - FastAPI for programmatic/mobile access
   - Same business logic used by both

3. REQUEST/RESPONSE PATTERN:
   - All API functions return {"success": bool, "message"/"data": any}
   - Consistent error handling across application

4. AUTHENTICATION:
   - Simple user_id based (no JWT tokens in API currently)
   - Should be enhanced for production (OAuth2, JWT tokens)

5. DATA VALIDATION:
   - Happens in finance_service layer before database
   - Pydantic models in FastAPI provide additional validation
   - Database constraints (CHECK, FOREIGN KEY) as safety net

6. DATABASE:
   - SQLite for simplicity (suitable for single-user or small team)
   - Would migrate to PostgreSQL/MySQL for production scale
   - Parameterized queries prevent SQL injection

7. VISUALIZATION:
   - Matplotlib (static) instead of interactive (Plotly, etc.)
   - Sufficient for MVP, can be enhanced later
   - 5 complementary chart types provide multiple perspectives

================================================================================
                              FUTURE ENHANCEMENTS
================================================================================

1. AUTHENTICATION & SECURITY:
   - Implement JWT tokens for API
   - Add OAuth2 for third-party integrations
   - Improve password hashing (bcrypt instead of SHA256)
   - Add rate limiting to API endpoints

2. DATABASE:
   - Migrate to PostgreSQL for production
   - Add database transactions for data consistency
   - Implement connection pooling

3. FEATURES:
   - Transaction editing/deletion in Streamlit UI
   - Budget tracking and alerts
   - Recurring transactions
   - Tags and notes on transactions
   - Receipt upload and OCR
   - Multi-user household finance tracking

4. ANALYTICS:
   - Interactive charts (Plotly instead of Matplotlib)
   - Forecasting and trend prediction
   - Income/expense ratios and metrics
   - Year-over-year comparisons
   - Spending by time-of-day analysis

5. UI/UX:
   - Mobile app (React Native, Flutter)
   - Dark mode
   - Custom color themes
   - Responsive design for tablets

6. BACKEND:
   - Email notifications for large transactions
   - Webhook integration for bank feeds
   - API rate limiting and authentication
   - Comprehensive logging and monitoring

================================================================================
                              TROUBLESHOOTING
================================================================================

STREAMLIT NOT STARTING:
- Check Python version: python --version (should be 3.8+)
- Check requirements installed: pip list | grep streamlit
- Try: pip install --upgrade streamlit

FASTAPI NOT ACCESSIBLE:
- Verify port 8000 not in use: netstat -ano | findstr 8000
- Ensure uvicorn installed: pip install uvicorn
- Check firewall allowing Python

DATABASE ERRORS:
- Delete data/finance.db to reset
- Ensure data/ directory exists
- Check file permissions in data/

LOGIN FAILURES:
- Verify user was registered successfully
- Check username/password for typos
- Try creating new test account

CHART NOT DISPLAYING:
- Ensure matplotlib installed: pip install matplotlib
- Try adding sample transactions first
- Check browser console for JavaScript errors

================================================================================
                              DEPENDENCIES EXPLAINED
================================================================================

streamlit>=1.30
- Web application framework
- Provides reactive UI, session state, form handling
- Auto-reloading during development
- Built-in data table and chart display

sqlalchemy>=2.0
- ORM library (installed but not actively used)
- Could replace raw SQL with ORM in future

pandas>=2.0
- Data manipulation and analysis
- Used for dataframe operations in charts

matplotlib>=3.7
- Static plotting library
- Generates all chart visualizations
- Returns figure objects Streamlit can display

bcrypt>=4.0
- Password hashing library (installed but not used)
- Could replace SHA256 hashing in production

python-dateutil>=2.8
- Flexible date parsing
- Used in utils/helpers.py for date_parse()

================================================================================
                              PROJECT STATISTICS
================================================================================

Total Files: 20+
Total Lines of Code: 1000+
Main Database Tables: 2 (users, transactions)
API Endpoints: 8
Chart Functions: 5
Main Features: 6

================================================================================
                              CONCLUSION
================================================================================

This Personal Finance Tracker is a well-structured Python project that demonstrates:
- Clean code organization with modular architecture
- Full-stack web application development
- REST API design and implementation
- Database design and SQL operations
- Data visualization and analytics
- User authentication and authorization
- Form validation and error handling

The project is suitable as a portfolio piece and can be extended with additional
features for real-world use. The dual interface (Streamlit + FastAPI) showcases
the ability to serve both user-facing and programmatic clients from shared logic.

================================================================================
                              END OF DOCUMENTATION
================================================================================
